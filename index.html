<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TaskHeat — POC (v5 restore)</title>
<link rel="stylesheet" href="./styles/main.css" />
</head>
<body>
<div id="app">
  <div id="topbar">
    <div class="left"><button id="menuBtn" class="iconbtn" title="Open command menu">☰</button><span id="title" style="margin-left:8px;font-weight:700">TaskHeat — POC</span></div>
    <div class="right">
      <span class="hint" id="modeHint">Tip: L to link, U to unlink. Long‑press for node menu.</span>
      <button id="viewModeBtn" class="iconbtn" title="Toggle Edit/Preview">👁 Preview</button>
      <button id="toggleAllDescBtn" class="iconbtn" title="Toggle all descriptions">▸ All</button>
      <button id="recomputeBtn" class="iconbtn" title="Recompute semantic colours" disabled>↻ Recompute</button>
      <button id="semanticBtn" class="iconbtn" title="Toggle semantic colouring">🎨 Semantics</button>
      <button id="themeBtn" class="iconbtn" title="Toggle dark/light">🌙</button>
    </div>
  </div>

  <div id="palette" role="dialog" aria-modal="true">
    <input id="palInput" placeholder="Task title…" />
    <div class="pal-list">
      <div class="pal-item" data-cmd="create"><span>Create task</span><span class="pal-kbd">Enter</span></div>
      <div class="pal-item" data-cmd="link"><span>Start link mode</span><span class="pal-kbd">L</span></div>
      <div class="pal-item" data-cmd="unlink"><span>Start unlink mode</span><span class="pal-kbd">U</span></div>
      <div class="pal-item" data-cmd="cancel"><span>Cancel current mode</span><span class="pal-kbd">Esc</span></div>
      <div class="pal-item" data-cmd="deleteSelected"><span>Delete selected node</span><span class="pal-kbd">Del</span></div>
    </div>
  </div>

  <div id="canvasWrap">
    <svg id="linkLayer" aria-hidden="true">
      <defs>
        <marker id="arrow" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto-start-reverse">
          <path d="M0,0 L12,4 L0,8 Z" fill="currentColor"></path>
        </marker>
      </defs>
    </svg>
    <div id="nodesLayer"></div>
  </div>

  <div id="debug"><div><strong>Debug Log</strong></div><ol id="logList"></ol></div>
</div>

<div id="ctxMenu" role="menu" aria-hidden="true">
  <button class="ctx-item" data-action="addHere">➕ Add task here</button>
  <div class="ctx-section"></div>
  <button class="ctx-item" data-action="startLink">🔗 Start link from this</button>
  <button class="ctx-item" data-action="startUnlink">🧹 Start unlink from this</button>
  <button class="ctx-item" data-action="seedCanvas">🌱 Seed canvas</button>
  <div class="ctx-section"></div>
  <button class="ctx-item" data-action="updateDesc">📝 Update description</button>
  <button class="ctx-item" data-action="rename">✏️ Rename title</button>
  <button class="ctx-item" data-action="delete">🗑️ Delete task</button>
</div>

<script type="module" src="./src/main.js"></script>
</body>
</html>
